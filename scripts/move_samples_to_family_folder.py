import os
import json
import csv
import shutil
from termcolor import colored
from os import scandir

# this script moves the malware samples to their family folders with hash values filtered with Virus Total json data
# important tags are "popular_threat_classification", "first_submission_date" and "data["data"]["attributes"]["last_analysis_stats"]["malicious"]"
input_directory = '/input_path'
output_path = '/output_path'

if not os.path.exists(output_path):
    os.makedirs(output_path)
    
# enumerates the files in input path
dir_entry = scandir(input_directory)
    
hash_file = open("trojan_XXX.txt","r") # hash list filtered according to family information
hashes = hash_file.read().splitlines()
copy_counter = 0
hash_count = 0
dir_count = 0

for entry in dir_entry:
	dir_count+=1	
	file_name = entry.name
	for line in hashes:
		if line in file_name:	
			input_path = input_directory + line
			shutil.copy(input_path , output_path)
			copy_counter+=1
			print("copy_counter = ", copy_counter)
			break
		else:
			continue
			
hash_file.close()