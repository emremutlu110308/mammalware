import os
import json
import csv
import shutil
from termcolor import colored
from os import scandir

# this scripts deletes the "VirusShare_" prenames of the samples downloaded from VirusShare platform and then copy them to output folder. 
# becuase filenames should be in a hash format for further actions like downloading information from Virus Total platform.

input_directory = '/path/to/virus_share_samples/VirusShare_NNNNN/'
output_path = '/path/to/virus_share_samples/VirusShare_NNNNN_final_exe_hashes/'

if not os.path.exists(output_path):
    os.makedirs(output_path)
    
# enumerates the files in input path
dir_entry = scandir(input_directory)
    
hash_file = open("hash.txt","r") #
hashes = hash_file.read().splitlines()

copy_counter = 0
hash_count = 0
dir_count = 0
count_error = 0

for entry in dir_entry:

	dir_count+=1	
	file_name = entry.name
	for line in hashes:
	try:
        hash_count+=1
		if line in file_name:
			input_file = input_directory + file_name
			output_file= output_path + line
			shutil.copy(input_file, output_file)
			copy_counter+=1
			print("copy_counter = ", copy_counter)
			break
		else:
			continue
	except:
		print(colored("ERROR hash : ",'red'),colored(line,'yellow'))
		count_error+=1
		continue
			
hash_file.close()
	    
