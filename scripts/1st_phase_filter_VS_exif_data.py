import os
import json
import csv
import shutil
from termcolor import colored
from os import scandir

# this program filters JSON data of exif info taken from virusshare. the aim is filtering the PE exe files from the garbage.
# filtering process has 2 phases. first one filters the line if it has "exe" value. second one filters the sample hash that has a VirusShare_ tag

# reads the input file
f = open ("VirusShare_NNNNN.zip.exiftool.json") # json file taken from virusshare platform that has unfiltered exif information of the samples
lines = f.read().splitlines()

# enumarates the lines in input file
count = 0
for line in lines:	
	if 'File:FileTypeExtension":"exe' in line:
		count+=1
		with open ("filtered_VirusShare_NNNNN.zip.exiftool.json","a") as g: # the line has exe information
			g.write(line + '\n')

print("***** " , count , " files exported *****")

f.close()	

print (colored("***** operation is completed *****" , 'green'))
