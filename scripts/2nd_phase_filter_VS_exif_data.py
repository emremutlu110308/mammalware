import os
import json
import csv
import shutil
from termcolor import colored
from os import scandir

# this program filters JSON data of exif info taken from virusshare. the aim is filtering the PE exe files from the garbage.
# filtering process has 2 phases. first one filters the line if it has "exe" value. second one filters the sample hash that has a VirusShare_ tag.

# tha data filtered in first phase should be put in "data" as follows { "data" :[  ]}

# reads the input file
f = open ("filtered_VirusShare_NNNNN.zip.exiftool.json")
data = json.load(f)

# enumarates the objects/dictionaries in input file
count = 0
for i in data['data']:
	
	file_name = i["SourceFile"]
	with open ("vs_NNNNN.txt" , "a") as g:
		g.write(file_name + '\n')
		print (colored("coppied to output : ", 'green'),colored(file_name,'white'))
	count += 1

print("***** " , count , " files exported *****")

f.close()	

print (colored("***** operation is completed *****" , 'green'))
